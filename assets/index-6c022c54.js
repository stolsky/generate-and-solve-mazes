(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();const l={BFS:0,DFS:1,DIJKSTRA:2,A_STAR:3},vt=[{ID:0,FULL:"BFS (Breadth-first search)",SHORT:"BFS"},{ID:1,FULL:"DFS (Depth-first search)",SHORT:"DFS"},{ID:2,FULL:"Dijkstra's algorithm",SHORT:"Dijkstra"},{ID:3,FULL:"A* search",SHORT:"A*"}],at={ID:-1,FULL:"Requested solver information not found",SHORT:"Error"},x=s=>vt[s]??at,U=[],wt=s=>{U.push(s)},M=()=>U,Q=()=>U.filter(s=>!s.is_finished),bt=(s,t)=>{const e=s.length>0?s:"div",i=document.createElement(e);return i instanceof HTMLElement&&t!==void 0&&t.length>0&&t.split(" ").filter(n=>n.length>0).forEach(n=>{i.classList.add(n)}),i},tt=s=>s<10?"0":"",W=s=>{const t=s/1e3,e=`${tt(t%60)}${(t%60).toFixed(2)}`,i=t/60;return`${`${tt(i%60)}${Math.floor(i%60)}`}:${e}`};class a{html_element;constructor(t="",e="span"){this.html_element=bt(e,t)}disable(){this.get_html_element().classList.add("Disabled")}enable(){this.get_html_element().classList.remove("Disabled")}get_html_element(){return this.html_element}hide(){return this.get_html_element().style.display="none",this}set_background_color(t){return this.get_html_element().style.backgroundColor=t,this}set_content(t){return this.html_element.textContent=t,this}show(){return this.get_html_element().style.display="block",this}}class c extends a{constructor(t="",e="div"){super(t,e)}append(...t){return t.forEach(e=>this.append_child(e)),this}append_child(t){return this.get_html_element().appendChild(t.get_html_element()),this}get_children(){return[...this.get_html_element().children]}scroll_to_bottom(){const t=this.get_html_element();t.scrollTop=t.scrollHeight}}class St{TWO_PI=Math.PI*2;renderer;constructor(t){this.renderer=t}clear(){const{width:t,height:e}=this.renderer.canvas;this.renderer.clearRect(0,0,t,e)}fill_rect(t,e,i,n,r){this.renderer.fillStyle=r,this.renderer.fillRect(t,e,i,n)}fill_circle(t,e,i,n){this.renderer.beginPath(),this.renderer.arc(t,e,i,0,this.TWO_PI),this.renderer.fillStyle=n,this.renderer.fill()}}class Lt extends c{title;canvas;position;create_canvas(t,e){const i=new a("Canvas","canvas"),n=i.get_html_element();return n.width=t,n.height=e,i}constructor(t,e){super("TaskCard"),this.title=new a("Title","h3"),this.canvas=this.create_canvas(t,e),this.position=new a("Position"),this.append_child(this.title).append_child(this.canvas).append_child(this.position)}get_context(){const t=this.canvas.get_html_element();return new St(t.getContext("2d"))}set_position(t){return this.position.set_content(t.toString(10)),this}set_title(t){return this.title.set_content(t),this}}const lt=[],Et=({tasks_amount:s,canvas_width:t,canvas_height:e})=>{const i=new c("Content");for(let n=0;n<s;n=n+1){const r=new Lt(t,e);i.append_child(r),lt.push(r)}return i},Rt=()=>lt,E=[],j=()=>E.length===0,B=()=>{if(!j()){const s=E.pop();s!==void 0&&s.exit()}},K=s=>{E.push(s),s.enter()},At=()=>{E.forEach(s=>{s.render()})},Tt=s=>{j()||E[E.length-1].update(s)};class ct{is_unlocked=!0;properties={};constructor(t){t.forEach(e=>{this.properties[e.key]={...e}})}get_property(t){return{...this.properties[t]}}get_property_value(t){return this.properties[t]?.value}set_property(t,e){this.is_unlocked&&t in this.properties&&(this.properties[t].value=e)}lock(){this.is_unlocked=!1}unlock(){this.is_unlocked=!0}}const Ot=[{key:"controls_icon_backward",value:"icon-backward2",type:"string"},{key:"controls_icon_forward",value:"icon-forward3",type:"string"},{key:"controls_icon_pause",value:"icon-pause2",type:"string"},{key:"controls_icon_play",value:"icon-play3",type:"string"},{key:"speed_multiplier_min",value:.125,type:"number"},{key:"speed_multiplier_default",value:1,type:"number"},{key:"speed_multiplier_max",value:16,type:"number"}],v=new ct(Ot);class O extends a{constructor(t,e){super(`IconButton ${t}`,"button"),this.get_html_element().addEventListener("pointerdown",e)}}let et,st,k,N,H,C;const P=()=>{N.hide(),k.show()},it=()=>{k.hide(),N.show()},nt=s=>{const e=ut()*s,i=zt(e);return i&&H.set_content(e.toString(10)+"x"),i},Ft=(s=!1)=>(et=new O(v.get_property_value("controls_icon_backward"),()=>{nt(.5)}),k=new O(v.get_property_value("controls_icon_play"),()=>{it(),rt()}),N=new O(v.get_property_value("controls_icon_pause"),()=>{P(),pt()}),s?(rt(),it()):P(),st=new O(v.get_property_value("controls_icon_forward"),()=>{nt(2)}),H=new a("Speed").set_content(ut().toString(10)+"x"),C=new a("Runtime").set_content("00:00.00"),new c("Controls").append(et,k,N,st,H,C)),It=s=>{C.set_content(W(s))};class Dt{request_id;callback;last_time;is_running;now(){return performance.now()}run=()=>{if(this.is_running){const t=this.now(),e=t-this.last_time;this.last_time=t,this.callback instanceof Function&&this.callback(e),this.request_id=requestAnimationFrame(this.run)}};constructor(){this.request_id=0,this.callback=void 0,this.last_time=0,this.is_running=!1}start(t){this.is_running||(this.callback=t,this.is_running=!0,this.last_time=this.now(),this.run())}stop(){cancelAnimationFrame(this.request_id),this.request_id=0,this.is_running=!1,this.last_time=0}}let I,T,ht,dt,z,X;const kt=s=>{j()&&(pt(),P());const t=z;if(t<1&&T<1/t){T=T+1;return}const e=t*s;I=I+e,It(I);for(let i=0;i<t;i=i+1)Tt(s),At();t<1&&(T=0)},Nt=(s,t)=>{I=0,T=0;const{max:e,min:i,std:n}=s??{max:1,min:1,std:1};ht=e,dt=i,z=n,X=t??new Dt},ut=()=>z,zt=s=>s>=dt&&s<=ht?(z=s,!0):!1,rt=()=>{X.start(kt)},pt=()=>{X.stop()};const Mt=(s,t)=>new c("Item").append(new a("Tile").set_background_color(s),new a("Label").set_content(t)),Ht=s=>{const t=new c("Items");return s.colors.forEach(e=>t.append_child(Mt(e.color,e.label))),new c("Legend").append(new a("Title","h3").set_content("Legend"),t)};let w;const Ct=[],Pt=()=>{Ct.push({...w})},$t=s=>{w!==void 0&&Pt(),w={id:s,setup:{},solutions:[]}},Gt=s=>{const{setup:t}=w;if(t!==void 0){const{generator_id:e,seed:i,maze_width:n,maze_height:r,maze_type:d,floor_tiles:y}=s;t.generator_id=e,t.seed=i,t.maze_width=n,t.maze_height=r,t.maze_type=d,t.floor_tiles=y}},qt=(s,t)=>{const{setup:e}=w;e!==void 0&&(e.start_position=s,e.goal_position=t)},Ut=s=>{if("solutions"in w){const{solver_id:t,path_length:e,expanded_nodes:i,time_taken_ms:n}=s,r=0;w.solutions.push({solver_id:t,path_length:e,expanded_nodes:i,time_taken_ms:n,points:r})}},Wt=s=>w.solutions.find(t=>t.solver_id===s),D=new Map,S=(s,t)=>{D.get(s).forEach(e=>{e(t??"")})},$=(s,t)=>{D.has(s)?D.get(s).push(t):D.set(s,[t])},G={},jt=s=>{if(s in G){const t=Wt(Number.parseInt(s,10));if(t!==void 0){const e=G[s].get_children();e[1].textContent=t.path_length.toString(10),e[2].textContent=t.expanded_nodes.toString(10),e[3].textContent=W(t.time_taken_ms),e[4].textContent=t.points.toString(10)}}},Bt=s=>{},Kt=s=>{const t=new c("","tr");return s.forEach(e=>{t.append_child(new a("","th").set_content(e.label))}),new c("","thead").append_child(t.append_child(new a("","th").set_content("points*")))},Xt=(s,t)=>{const e=new c("","tbody");return s.forEach(i=>{const n=new c("","tr");G[i.id.toString(10)]=n,n.append_child(new a("","td").set_content(i.label));for(let r=1;r<t+1;r=r+1)n.append_child(new a("","td").set_content("-"));e.append_child(n)}),e},Yt=()=>new a("Hint","p").set_content("*accumulated sum of received points of each iteration"),Jt=s=>($("SolutionReady",jt),$("AllSolutionsFinished",Bt),new c("Results").append(new a("Title","h3").set_content("Results"),new c("Table","table").append(Kt(s.columns),Xt(s.rows,s.columns.length)),Yt()));let q;const Vt=(s,t)=>W(Number.parseInt(t,10)),Zt=s=>s.indexOf("%t")!==-1?s.replace(/%t(\d+)/,Vt):s,Qt=s=>{q.append_child(new a().set_content(Zt(s))).scroll_to_bottom()},te=()=>($("Log",Qt),q=new c("Text"),new c("Log").append(new a("Title","h3").set_content("Log"),q)),ee=(s,t,e)=>{const i=new c("Layout").append(Et(s),new c("Navigation").append(Jt(t),te(),Ht(e),Ft()));document.body.appendChild(i.get_html_element())},se=[{key:"delay_after_finished",value:5e3,type:"number"},{key:"generator_id",value:1,type:"number"},{key:"grid_cell_size",value:10,type:"number"},{key:"grid_height",value:41,type:"number"},{key:"grid_width",value:41,type:"number"},{key:"iterations",value:10,type:"number"},{key:"maze_type",value:0,type:"number"},{key:"tasks_amount",value:4,type:"number"}],u=new ct(se),o={NONE:-1,FLOOR:0,WALL:1,START:2,GOAL:3},_={NONE:-1,SEARCH:4,EXPANDED:5,PATH:6},ie=s=>{let t=1779033703^s.length;for(let e=0;e<s.length;e=e+1)t=Math.imul(t^s.charCodeAt(e),3432918353),t=t<<13|t>>>19;return()=>(t=Math.imul(t^t>>>16,2246822507),t=Math.imul(t^t>>>13,3266489909),t=t^t>>>16,t>>>0)},ne=2**32,re=(s,t,e,i)=>()=>{const n=t<<9;let r=s*5;return r=(r<<7|r>>>25)*9,e=e^s,i=i^t,t=t^e,s=s^i,e=e^n,i=i<<11|i>>>21,(r>>>0)/ne};let gt;const b=(s=0,t=1)=>{const e=gt();return Number.isFinite(s)&&Number.isFinite(t)?s+e*(t-s):e},ft=(s="")=>{const t=s.length===0?`${Math.random()}`:s,e=ie(t);gt=re(e(),e(),e(),e())};ft();const A={EMPTY_MAZE:0,GROWING_TREE:1,KRUSKALS_ALGORITHM:2,PRIMS_ALGORITHM:3,RECURSIVE_BACKTRACKING:4},oe=[{ID:0,FULL:"",SHORT:"Empty"},{ID:1,FULL:"",SHORT:"GrowingTree"},{ID:2,FULL:"",SHORT:"Kruskal"},{ID:3,FULL:"",SHORT:"Prim"},{ID:4,FULL:"",SHORT:"RecursiveBacktracking"}],mt={ID:-1,FULL:"Requested generator information not found",SHORT:"Error"},_e=s=>oe[s]??mt;class R{_x=-1;_y=-1;_f;_g;_type=o.NONE;_sub_type=_.NONE;_predecessor;constructor(t,e,i){this.type=i,this.x=t,this.y=e,this._f=0,this._g=Number.MAX_SAFE_INTEGER,this._predecessor=void 0}get f(){return this._f}set f(t){this._f=t}get g(){return this._g}set g(t){this._g=t}get predecessor(){return this._predecessor}set predecessor(t){this._predecessor=t}get sub_type(){return this._sub_type}set sub_type(t){this._sub_type=t}get type(){return this._type}set type(t){this._type=t}get x(){return this._x}set x(t){Number.isInteger(t)&&(this._x=t)}get y(){return this._y}set y(t){Number.isInteger(t)&&(this._y=t)}}class Y{store;constructor(){this.store=[]}add_unique(t){return this.store.find(e=>e.x===t.x&&e.y===t.y)===void 0?(this.store.push(t),!0):!1}clear(){this.store=[]}get_all(){return this.store}get_cell(t){return this.store.at(t)}get_size(){return this.store.length}has(t){return this.store.includes(t)}remove(t){return this.store.splice(t,1).pop()}}class L{static calculate_von_neumann_directions=(t,e)=>[{x:t,y:e-1},{x:t+1,y:e},{x:t,y:e+1},{x:t-1,y:e}];static calculate_moore_directions=(t,e)=>[{x:t,y:e-1},{x:t+1,y:e-1},{x:t+1,y:e},{x:t+1,y:e+1},{x:t,y:e+1},{x:t-1,y:e+1},{x:t-1,y:e},{x:t-1,y:e-1}];_width;_height;cells;is_inside(t,e){return t>-1&&t<this.width&&e>-1&&e<this.height}get_neighbourhood_from_directions(t){const e=[];return t.forEach(i=>{const n=this.get_cell(i.x,i.y);n!==void 0&&e.push(n)}),e}hash_index(t,e){return t*this.height+e}constructor(t,e){this._width=t,this._height=e,this.cells=[]}get height(){return this._height}get width(){return this._width}clean_copy(){const t=new L(this.width,this.height);for(let e=0;e<this.width;e=e+1)for(let i=0;i<this.height;i=i+1){const n=this.hash_index(e,i),r=this.cells[n];t.cells[n]=new R(e,i,r.type)}return t}get_cell(t,e){if(this.is_inside(t,e))return this.cells[this.hash_index(t,e)]}get_moore_neighbourhood(t){return this.get_neighbourhood_from_directions(L.calculate_moore_directions(t.x,t.y))}get_adjacent_neighbours(t){return this.get_neighbourhood_from_directions(L.calculate_von_neumann_directions(t.x,t.y))}init(t){for(let e=0;e<this.width;e=e+1)for(let i=0;i<this.height;i=i+1)this.cells[this.hash_index(e,i)]=new R(e,i,t)}each(t){this.cells.forEach(e=>{t(e)})}}class ae{updates;constructor(){this.updates=[]}add(t){this.updates.push(t)}clear(){this.updates=[]}get_all(){return this.updates}}class m{static Index={FIRST:1,LAST:2,RANDOM:3};_id;grid;store;updates;start_position;goal_position;_expanded_cells_count;static euclidean_distance(t,e){return Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2)}static manhatten_distance(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}constructor(t,e,i){this._id=t,this.grid=e??new L(0,0),this.store=i??new Y,this.updates=new ae,this._expanded_cells_count=0}choose_index_by_type(t){let e=0;return t===m.Index.LAST?e=this.store.get_size()-1:t===m.Index.RANDOM&&(e=Math.floor(b(0,this.store.get_size()-1))),e}update_as_expanded(t){this._expanded_cells_count=this._expanded_cells_count+1,t.sub_type=_.EXPANDED,this.updates.add(t)}get expanded_cells_count(){return this._expanded_cells_count}get id(){return this._id}find_random_position(){const t=Math.floor(b(1,this.get_grid().width-2)),e=Math.floor(b(1,this.get_grid().height-2));return{x:t,y:e}}get_grid(){return this.grid}get_updates(){const t=this.updates.get_all();return this.updates.clear(),t}is_finished(){return this.store.get_size()===0}perform_step(){}create_start_cell(t){const{x:e,y:i}=t,n=this.get_grid().get_cell(e,i)??new R(1,1,o.FLOOR);return this.start_position={x:e,y:i},n.type=o.START,this.updates.add(n),n}create_goal_cell(t){const{x:e,y:i}=t,n=this.get_grid().get_cell(e,i)??new R(this.get_grid().width-2,this.get_grid().height-2,o.FLOOR);return this.goal_position={x:e,y:i},n.type=o.GOAL,this.updates.add(n),n}}class J extends m{carve_passage(t,e,i){const n=[t];for(let r=0;r<i;r=r+1){const{x:d,y}=n[n.length-1],p=d+e.x,g=y+e.y;if(p===0||p===this.get_grid().width-1||g===0||g===this.get_grid().height-1){this.expand_position(p,g,o.WALL);break}const Z=this.get_grid().get_cell(p,g);n.push(Z),this.expand_position(p,g,o.FLOOR),r<i-1&&this.create_walls(Z,e)}return n}create_walls(t,e){const i=o.WALL,n=t.x,r=t.y;e.x!==0&&(this.expand_position(n,r-1,i),this.expand_position(n,r+1,i)),e.y!==0&&(this.expand_position(n-1,r,i),this.expand_position(n+1,r,i))}expand_position(t,e,i){const n=this.get_grid().get_cell(t,e);n!==void 0&&n.sub_type!==_.EXPANDED&&(n.type=i,n.sub_type=_.EXPANDED)}update_passage(t){t.forEach((e,i)=>{i===0||i===t.length-1?(e.sub_type=_.SEARCH,this.store.add_unique(e)):e.sub_type=_.EXPANDED,this.updates.add(e)})}constructor(t,e,i,n){super(t,e,n),this.get_grid().init(i??o.NONE)}create_passage(t,e,i=2){const n=this.carve_passage(t,{x:e.x-t.x,y:e.y-t.y},i);return this.update_passage(n),n}init_start_cell(t,e){t!==void 0&&(t.sub_type=_.SEARCH,this.store.add_unique(t),e instanceof Function&&e(t))}set_start_position(t){}}class le extends J{constructor(t,e){super(t,e,o.WALL);const i=e.get_cell(1,1);if(i!==void 0)for(this.store.add_unique(i);!this.is_finished();){const n=this.store.remove(0);n!==void 0&&(n.type=o.FLOOR,e.get_adjacent_neighbours(n).forEach(r=>{r.type===o.WALL&&r.x>0&&r.x<e.width-1&&r.y>0&&r.y<e.height-1&&this.store.add_unique(r)}))}}is_finished(){return this.store.get_size()===0}}const ce=(s,t)=>{const e=Math.ceil(s*.25),i=s-e,n=Math.ceil(t*.25),r=t-n,d=Math.floor(s*.5),y=Math.floor(t*.5),p=Math.ceil(s*.125),g=Math.ceil(t*.125);return[{x_min:1,x_max:e,y_min:1,y_max:n},{x_min:i,x_max:s-2,y_min:1,y_max:n},{x_min:i,x_max:s-2,y_min:r,y_max:t-2},{x_min:1,x_max:e,y_min:r,y_max:t-2},{x_min:d-p,x_max:d+p,y_min:y-g,y_max:y+g}]},ot=s=>{if(s!==void 0)return{x:Math.floor(b(s.x_min,s.x_max)),y:Math.floor(b(s.y_min,s.y_max))}},he=(s,t)=>{const e=ce(s,t);return V(e),{start:ot(e.pop())??{x:1,y:1},goal:ot(e.pop())??{x:s-2,y:t-2}}},_t=(s,t)=>{let e=t.get_cell(s.x,s.y);if(e instanceof R&&e.type===o.WALL){const i=t.get_moore_neighbourhood(e);V(i),e=i.filter(n=>n.type===o.FLOOR).pop(),e instanceof R?(s.x=e.x,s.y=e.y):(s.x=0,s.y=0)}return s},de=s=>{const{start:t,goal:e}=he(s.width,s.height);return{start:_t(t,s),goal:_t(e,s)}},V=s=>{for(let t=s.length-1;t>0;t--){const e=Math.floor(b()*(t+1));[s[t],s[e]]=[s[e],s[t]]}};class F extends J{index_type;get_random_cell(t){return V(t),t[0]}get_unvisited_neighbours(t){return this.get_grid().get_adjacent_neighbours(t).filter(e=>e.sub_type!==_.EXPANDED&&this.is_next_cell_available(t,e))}is_next_cell_available(t,e){const i=e.x*2-t.x,n=e.y*2-t.y,r=this.get_grid().get_cell(i,n);return r!==void 0&&r.sub_type!==_.SEARCH&&r.sub_type!==_.EXPANDED}remove_cell(t){const e=this.store.remove(t);e!==void 0&&(e.sub_type=_.EXPANDED,this.updates.add(e))}constructor(t,e,i=m.Index.LAST){super(t,e,o.WALL),this.index_type=i}perform_step(){const t=this.choose_index_by_type(this.index_type),e=this.store.get_cell(t);if(e===void 0)return;const i=this.get_unvisited_neighbours(e);if(i.length===0){this.remove_cell(t);return}this.create_passage(e,this.get_random_cell(i))}set_start_position(t){super.init_start_cell(super.create_start_cell(t))}}const ue=(s,t)=>s===A.EMPTY_MAZE?new le(s,t):s===A.GROWING_TREE?new F(s,t):s===A.KRUSKALS_ALGORITHM?new F(s,t,m.Index.FIRST):s===A.PRIMS_ALGORITHM?new F(s,t,m.Index.RANDOM):s===A.RECURSIVE_BACKTRACKING?new F(s,t,m.Index.LAST):new J(mt.ID),pe=[{ID:0,FULL:"perfect maze",SHORT:"perfect"},{ID:1,FULL:"imperfect mazes",SHORT:"imperfect"},{ID:2,FULL:"obstacles",SHORT:"obstacles"}],ge={ID:-1,FULL:"Requested maze information not found",SHORT:"Error"},fe=s=>pe[s]??ge;class f extends m{static WEIGHT_OF_EDGE=1;_path_length;constructor(t,e,i){super(t,e,i),this._path_length=0}construct_path(t){let e=t;for(e.sub_type=_.PATH,this.updates.add(e);e.predecessor!==void 0;){const i=e.predecessor;i.sub_type=_.PATH,this.updates.add(i),e=i}this._path_length=this.updates.get_all().length}discover_cell_from_source(t,e){t.predecessor=e,t.sub_type=_.SEARCH,this.store.add_unique(t),this.updates.add(t)}get_adjacent_neighbours(t){return this.get_grid().get_adjacent_neighbours(t).filter(e=>e.type!==o.WALL&&e.sub_type!==_.EXPANDED)}get_next_cell(t){if(this.is_finished())return;const e=this.store.remove(t);if(e.type===o.GOAL){this.store.clear(),this.construct_path(e);return}return this.update_as_expanded(e),e}is_finished(){return this.store.get_size()===0}init_start_cell(t,e){t!==void 0&&(this.store.add_unique(t),e instanceof Function&&e(t))}set_start_position(t){}get path_length(){return this._path_length}}class yt extends Y{add_unique(t){if(this.store.find(e=>e.x===t.x&&e.y===t.y)===void 0){let e=0,i=this.store.length;for(;e<i;){const n=e+i>>>1;this.store[n].f<t.f?e=n+1:i=n}return this.store.splice(e,0,t),!0}return!1}}class me extends f{closed_set;heuristic(t){return f.manhatten_distance({x:t.x,y:t.y},{x:this.goal_position?.x??0,y:this.goal_position?.y??0})}constructor(t,e){super(t,e,new yt),this.closed_set=new Y}perform_step(){const t=this.get_next_cell(0);t!==void 0&&(this.closed_set.add_unique(t),this.get_adjacent_neighbours(t).forEach(e=>{const i=t.g+f.WEIGHT_OF_EDGE;i<e.g&&(e.g=i,e.f=i+this.heuristic(e),this.discover_cell_from_source(e,t))}))}set_start_position(t){super.init_start_cell(super.create_start_cell(t),e=>{e.g=0})}}class ye extends f{perform_step(){const t=this.get_next_cell(0);t!==void 0&&this.get_adjacent_neighbours(t).forEach(e=>{this.discover_cell_from_source(e,t)})}set_start_position(t){super.init_start_cell(super.create_start_cell(t))}}class xe extends f{perform_step(){const t=this.get_next_cell(-1);t!==void 0&&this.get_adjacent_neighbours(t).forEach(e=>{this.discover_cell_from_source(e,t)})}set_start_position(t){super.init_start_cell(super.create_start_cell(t))}}class ve extends f{constructor(t,e){super(t,e,new yt)}perform_step(){const t=this.get_next_cell(0);t!==void 0&&this.get_adjacent_neighbours(t).forEach(e=>{e.f=t.f+f.WEIGHT_OF_EDGE,this.discover_cell_from_source(e,t)})}set_start_position(t){super.init_start_cell(super.create_start_cell(t),e=>{e.f=0})}}const we=(s,t)=>s===l.A_STAR?new me(s,t):s===l.BFS?new ye(s,t):s===l.DFS?new xe(s,t):s===l.DIJKSTRA?new ve(s,t):new f(at.ID);class be{cell_size;delay_after_finished;goal_position;start_position;finished_timestamp;runtime;constructor(t){this.cell_size=u.get_property_value("grid_cell_size"),this.delay_after_finished=u.get_property_value("delay_after_finished"),this.finished_timestamp=0,this.runtime=0;const{start:e,goal:i}=de(t);this.start_position=e,this.goal_position=i,M().forEach(n=>{const r=we(n.get_solver_id(),t.clean_copy());r.set_start_position(e),r.create_goal_cell(i),n.solver=r})}enter(){qt(this.start_position,this.goal_position)}exit(){S("AllSolutionsFinished")}render(){Q().forEach(t=>{const e=t.solver;e instanceof f&&(t.render(e.get_updates(),this.cell_size),e.is_finished()&&(t.is_finished=!0))})}update(t){this.runtime=this.runtime+t;const e=Q();e.length===0&&(this.finished_timestamp===0?this.finished_timestamp=this.runtime:this.runtime-this.finished_timestamp>this.delay_after_finished&&B()),e.forEach(i=>{const n=i.solver;n instanceof f&&(n.perform_step(),n.is_finished()&&(Ut({solver_id:n.id,path_length:n.path_length,expanded_nodes:n.expanded_cells_count,time_taken_ms:this.runtime}),S("SolutionReady",`${n.id}`)))})}}class Se{generator_id;maze_type;maze_width;maze_height;seed;start_position;generator;cell_size;runtime;count_floor_tiles;reset_generating_variables(){const t=[];return this.generator.get_grid().each(e=>{(e.type===o.START||e.type===o.GOAL)&&(e.type=o.FLOOR),e.sub_type=_.NONE,e.sub_type=_.NONE,t.push(e),e.type===o.FLOOR&&(this.count_floor_tiles=this.count_floor_tiles+1)}),t}render_updates(t){M().forEach(e=>{e.render(t,this.cell_size)})}adjust_start_position(t){const{x:e,y:i}=t;return e%2===0&&(t.x=e-1),i%2===0&&(t.y=i-1),t}constructor(){this.generator_id=u.get_property_value("generator_id"),this.maze_type=u.get_property_value("maze_type"),this.maze_width=u.get_property_value("grid_width"),this.maze_height=u.get_property_value("grid_height"),this.seed=Math.floor(b(0,Date.now())).toString(10),ft(this.seed),this.generator=ue(this.generator_id,new L(this.maze_width,this.maze_height)),this.start_position=this.adjust_start_position(this.generator.find_random_position()),this.generator.set_start_position(this.start_position),this.cell_size=u.get_property_value("grid_cell_size"),this.runtime=0,this.count_floor_tiles=0,S("Log",`Seed ${this.seed}`),S("Log",`Start generating at ${this.start_position.x}:${this.start_position.y}`)}enter(){M().forEach(t=>{t.reset()})}exit(){Gt({generator_id:this.generator.id,seed:this.seed,maze_width:this.maze_width,maze_height:this.maze_height,maze_type:this.maze_type,start_position:this.start_position,floor_tiles:this.count_floor_tiles});const t=fe(this.maze_type).FULL,e=_e(this.generator_id).SHORT;S("Log",`Generated ${t} in %t${this.runtime} with ${e}`)}render(){this.render_updates(this.generator.get_updates()),this.generator.is_finished()&&(this.render_updates(this.reset_generating_variables()),B(),K(new be(this.generator.get_grid().clean_copy())))}update(t){this.runtime=this.runtime+t,this.generator.perform_step()}}class Le{current_iteration;max_iterations;constructor(){this.current_iteration=1,this.max_iterations=u.get_property_value("iterations")}enter(){}exit(){}render(){}update(){this.current_iteration<=this.max_iterations?(S("Log",`Processing iteration ${this.current_iteration} of ${this.max_iterations}`),$t(this.current_iteration),K(new Se)):B(),this.current_iteration=this.current_iteration+1}}const h={expanded:{color:"#9ec1cf",label:"Expanded",type:_.EXPANDED},floor:{color:"#FFFFFF",label:"Floor",type:o.FLOOR},goal:{color:"#9ee09e",label:"Goal",type:o.GOAL},path:{color:"#cc99c9",label:"Path",type:_.PATH},search:{color:"#feb144",label:"Search",type:_.SEARCH},start:{color:"#ff6663",label:"Start",type:o.START},wall:{color:"#000000",label:"Wall",type:o.WALL}},xt=s=>Object.values(h).find(t=>t.type===s)?.color??"",Ee=s=>xt(s),Re=s=>xt(s);class Ae{renderer;solver_id;_solver;_is_finished;constructor(t,e){this.renderer=t,this.solver_id=e,this._is_finished=!1}get is_finished(){return this._is_finished}set is_finished(t){this._is_finished=t}get solver(){return this._solver}set solver(t){this._solver=t}reset(){this.renderer.clear(),this.is_finished=!1,this._solver=void 0}get_solver_id(){return this.solver_id}render(t,e){t.forEach(i=>{const n=Ee(i.type);this.renderer.fill_rect(i.x*e,i.y*e,e,e,n);const r=Re(i.sub_type);r!==void 0&&this.renderer.fill_rect(i.x*e+2,i.y*e+2,e-4,e-4,r)})}}class Te{_max;_min;_std;constructor(t=0,e=0,i=0){this._max=t,this._min=e,this._std=i}get max(){return this._max}get min(){return this._min}get std(){return this._std}set std(t){this._std=t}}const Oe=()=>{v.lock(),u.lock();const s=u.get_property_value("grid_width"),t=u.get_property_value("grid_height"),e=u.get_property_value("grid_cell_size"),i=u.get_property_value("tasks_amount"),n=[x(l.BFS),x(l.DFS),x(l.DIJKSTRA),x(l.A_STAR)],r=[{color:h.floor.color,label:h.floor.label},{color:h.wall.color,label:h.wall.label},{color:h.start.color,label:h.start.label},{color:h.goal.color,label:h.goal.label},{color:h.search.color,label:h.search.label},{color:h.expanded.color,label:h.expanded.label},{color:h.path.color,label:h.path.label}];Nt(new Te(v.get_property_value("speed_multiplier_max"),v.get_property_value("speed_multiplier_min"),v.get_property_value("speed_multiplier_default"))),ee({canvas_width:s*e,canvas_height:t*e,tasks_amount:i},{columns:[{id:1,label:""},{id:2,label:"path length"},{id:3,label:"expanded nodes"},{id:4,label:"time taken"}],rows:[{id:l.BFS,label:x(l.BFS).SHORT},{id:l.DFS,label:x(l.DFS).SHORT},{id:l.DIJKSTRA,label:x(l.DIJKSTRA).SHORT},{id:l.A_STAR,label:x(l.A_STAR).SHORT}]},{colors:r}),Rt().forEach((d,y)=>{const{ID:p,FULL:g}=n[y];d.set_title(g),wt(new Ae(d.get_context(),p))}),K(new Le)};Oe();
